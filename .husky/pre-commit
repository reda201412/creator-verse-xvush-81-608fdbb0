#!/usr/bin/env sh
set -e

echo "ğŸš€ PrÃ©paration du commit..."

# Obtenir uniquement les fichiers modifiÃ©s et ajoutÃ©s
FILES=$(git diff --cached --name-only --diff-filter=ACM "*.{js,jsx,ts,tsx}" | tr '\n' ' ' | sed 's/ *$//')

if [ -z "$FILES" ]; then
    echo "â„¹ï¸  Aucun fichier JavaScript/TypeScript Ã  vÃ©rifier."
    exit 0
fi

echo "ğŸ” VÃ©rification du code avec ESLint..."
npx eslint --max-warnings=0 --config .eslintrc.json $FILES

echo "ğŸ¨ Formatage du code avec Prettier..."
npx prettier --write $FILES

# Ajouter les fichiers formatÃ©s au staging area
git add $FILES

echo "âœ… VÃ©rifications terminÃ©es avec succÃ¨s !"
exit 0
